---
tags: AI2613, solution, 2022Spring
---
$$
\def\*#1{\mathbf{#1}} \def\+#1{\mathcal{#1}} 
\def\-#1{\mathrm{#1}}\def\^#1{\mathbb{#1}}\def\!#1{\mathtt{#1}}
\newcommand{\norm}[1]{\left\Vert#1\right\Vert}
\newcommand{\abs}[1]{\left\vert#1\right\vert}
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\tuple}[1]{\left(#1\right)} \newcommand{\eps}{\varepsilon}
\newcommand{\inner}[2]{\langle #1,#2\rangle} \newcommand{\tp}{\tuple}
\renewcommand{\mid}{\;\middle\vert\;} \newcommand{\cmid}{\,:\,}
\newcommand{\numP}{\#\mathbf{P}} \renewcommand{\P}{\mathbf{P}}
\newcommand{\defeq}{\triangleq} \renewcommand{\d}{\,\-d}
\newcommand{\ol}{\overline}
\newcommand{\Pr}[2][]{\mathbf{Pr}_{#1}\left[#2\right]}
\newcommand{\E}[2][]{\mathbf{E}_{#1}\left[#2\right]}
\newcommand{\Var}[2][]{\mathbf{Var}_{#1}\left[#2\right]}
\renewcommand{\emptyset}{\varnothing}
$$

# [Solution of Homework 1]

## Probability Space of Tossing Coins

Let us construct the probability space of tossing an infinite sequence of independent fair coins. Let $\Omega=\set{0,1}^*$. We can write each $\omega\in\Omega$ as an infinite sequence $\omega=(\omega_1,\omega_2,\dots)$ where $\omega_i\in\set{0,1}$. 

1. Let $n\in\^N$. For every $s=(s_1,\dots,s_n)\in\set{0,1}^n$, let
$$
    C_s=\set{\omega\in\Omega\mid \omega_1=s_1,\dots,\omega_n=s_n}.
$$
Prove that for every $n\in\^N$, the collection $\set{C_s}_{s\in\set{0,1}^n}$ forms a partition of $\Omega$.
*Proof.* 
    For any $\omega \in \Omega$, there is exactly one $s=(\omega_1,\omega_2,\dots,\omega_n)\in \{0,1\}^n$ such that $\omega \in C_s$. Therefore, $\cup_{s\in\{0,1\}^n}C_s=\Omega$ and $C_{s_1}\cap C_{s_2}=\emptyset$ for any $s_1\neq s_2\in \{0,1\}^n$, which is to say $\set{C_s}_{s\in\set{0,1}^n}$ forms a partition of $\Omega$.

1. Let $\+F_n$ be the $\sigma$-algebra generated by $\set{C_s}_{s\in\set{0,1}^n}$ (that is, the minimal $\sigma$-algebra containing sets in $\set{C_s}_{s\in\set{0,1}^n}$). Note that $\+F_n$ is called the $\sigma$-algebra of *tossing $n$ coins*. Prove that there exists a bijection between $\+F_n$ and $2^{\set{0,1}^n}$.
    *Proof.* 
    We construct a map $f:\+F_n\rightarrow 2^{\set{0,1}^n}$ for any $A\in\+F_n$:
    $$f(A)=\cup_{\omega\in A} \set{(\omega_1,\omega_2,\dots,\omega_n)}.$$
        For any $S=\set{s^1,\dots,s^k} \in 2^{\set{0,1}^n}$, $f(\cup_{i=1}^k C_{s^i})=S$. So $f$ is surjective. 
        Since both $\+F_n$ and $2^{\{0,1\}^n}$ are of size $2^{2^n}$, we can infer that $f$ is a bijection between $\+F_n$ and $2^{\set{0,1}^n}$. 
       
    
1. Prove that $\+F_1\subsetneq \+F_2\subsetneq \dots$ is increasing. The collection $\set{\+F_n}_{n\ge 1}$ is called a *filtration*.
    *Proof.*
    We will prove  $\+F_n \subsetneq \+F_{n+1}$ for every $n$.
    Let $f:\+F_n \rightarrow 2^{\set{0,1}^n}$ be the bijection defined in Problem 2. For any $A\in\+F_n$, we write it as $\cup_{s \in f(A)} C_s$. For any $s=(s_1,s_2,\dots,s_n)\in\set{0,1}^n$, we write $C_s = C_{(s_1,s_2,\dots,s_n,0)}\cup C_{(s_1,s_2,\dots,s_n,1)}$. Therefore, for any $A\in \+F_n$, $A = \cup_{s\in f(A)} (C_{(s_1,s_2,\dots,s_n,0)}\cup C_{(s_1,s_2,\dots,s_n,1)}) \in \+F_{n+1}$, which implies $\+F_n \subset \+F_{n+1}$. It is obvious that $\+F_n\neq \+F_{n+1}$ (For example, $C_{\left(s_1,s_2,\dots,s_{n+1}\right)}\in \+F_{n+1}$ but not in $\+F_n$), so $\+F_n \subsetneq \+F_{n+1}$.
    
1. Let $\+F_{\infty}=\bigcup_{n\ge 1}\+F_n$. Prove that $\+F_{\infty}$ is an algebra[^algebra] (not necessarily a $\sigma$-algebra) and $\+F_{\infty}\ne 2^\Omega$.
    *Proof.*
    For any $A \in \+F_{\infty}$, there exists $i$ such that $A \in \+F_i$, so $A^c \in \+F_i \subset \+F_{\infty}$. For any $A,B\in \+F_{\infty}$, there exist $i,j$ such that $A \in \+F_i$ and $B \in \+F_j$, so $A \cup B \in \+F_{\max\{i,j\}} \subset \+F_{\infty}$. Therefore, $\+F_{\infty}$ is an algebra.
    $2^\Omega$ is not countable. $\+F_{n}$ is countable for any $n$, so $\+F_{\infty}$ is also countable. Therefore, $\+F_{\infty}\ne 2^\Omega$. (In the following problem, we will show that any $\omega\in\Omega$, $\{\omega\}\in 2^\Omega\setminus\+F_\infty$.)
    
1. Let $\+B(\Omega)\defeq \sigma(\+F_\infty)$ be the minimal $\sigma$-algebra containing $\+F_\infty$. Prove that for any $\omega\in\Omega$, it holds that $\set{\omega}\in \+B(\Omega)\setminus\+F_{\infty}$.
    *Proof.*
    For any $\omega = (\omega_1, \omega_2, \dots) \in \Omega$, $\set{\omega} \in 2^{\Omega}$. However, there doesn't exist $i$ such that $\set{\omega} \in\+F_i$, hence $\set{\omega} \notin \+F_{\infty}$. 
    For any $\omega = (\omega_1, \omega_2, \dots) \in \Omega$ and $n$, $\omega \in C_{(\omega_1, \omega_2,\dots, \omega_n)}$. Therefore, $\set{\omega}=\cap_{n\geq 1} C_{(\omega_1, \omega_2,\dots, \omega_n)}\in \+B(\Omega)$.
    
    (Notes that we use the union operation to define the $\sigma$-algebra, but for any $A_i\in\+F,i\in \^N$, we have $\overline{\cup_i \bar{A_i}}=\cap_i A_i\in \+F$ because $\bar{A_i}\in\+F$.)
    
1. Prove that for every $A\in\+F_\infty$, there exist some $n\in\^N$ and $s_1,\dots,s_k\in\set{0,1}^n$ such that $A=C_{s_1}\cup\dots\cup C_{s_k}$. Although the choice of $n$ might not be unique, prove that the value $\frac{k}{2^n}$ only depends on $A$. 
    *Proof.*
    There exists $n$ such that $A\in \+F_n$. Let $f_n:\+F_n \rightarrow 2^{\set{0,1}^n}$ be the bijection defined in Problem 2. Let $f_n(A)=\set{s^1,s^2,\dots, s^{k_n}}$. Then $A=C_{s^1}\cup\dots\cup C_{s^{k_n}}$. 
    Let $n$ be the minimum index such that $A\in \+F_n$. We can also find a set $S'=\set{(s_1,s_2,\cdots,s_n,0),(s_1,s_2,\cdots,s_n,1) |s=(s_1,s_2,\dots,s_n)\in f_n(A)} \in 2^{\set{0,1}^{n+1}}$ such that $A=\cup_{s'\in S'} C_{s'}$ and $k_{n+1}:=|S'|=2k_n$. Therefore,$\frac{k_{n+1}}{2^{n+1}}=\frac{2k_n}{2^{n+1}}=\frac{k_n}{2^n}$. Applying this procedure inductively, we obtain that for any $i>n$, the value $\frac{k_i}{2^i}=\frac{k_n}{2^n}$, which is to say that $\frac{k}{2^n}$ only depends on $A$.
    
1. Prove that there exists a unique probability measure $P:\+B(\Omega)\to[0,1]$ satisfying for every $A\in\+F_{\infty}$, $P(A)=\frac{k}{2^n}$ where $k$ and $n$ are defined in the last question.
    *Proof.*
    We define a measure $\mu$ on $F_{\infty}$ that $\mu(A)=\frac{k}{2^n}$ where $k$ and $n$ are defined in the last question:
    1. $\mu(C_s) = \frac{1}{2^n}$ for $s\in \set{0,1}^n$.
    2. $\mu(A) = \sum_{i=1}^k P(C_{s^k})=\frac{k}{2^n}$ for $A = \cup_{i=1}^k C_{s^k} \in \+F_n$.
    For any disjoint sets $A_1,A_2,\dots \in \+F_{\infty}$ such that $\cup_{n\geq 1}A_n \in \+F_{\infty}$, assuming $A_i = \cup_{s \in S_i} C_{s}$, we obtain that $A = \cup_{s \in S_i, i\in \^N^+} C_{s}$.
    Therefore,
    $$\mu(\cup_{n\geq 1}A_n)=\sum_{n\geq 1}\mu(A_n),$$
    and it is obvious that $\mu(\Omega)= \sum_{s \in 2^{\{0,1\}^n}} \mu(C_s) = 1$.
    And then we extend the measure $\mu$ on $\+F_{\infty}$ to a measure on $\+B(\Omega)$ by *CarathÃ©odory Extension Theorem*.  There exists a unique measure $P:\+B(\Omega)\rightarrow [0,1]$ such that $P(A)=\mu(A)$ for any $A\in\+F_{\infty}$. Since $P(\Omega)=\mu(\Omega)=1$, $P$ is a probability measure.
    

Then $(\Omega,\+B(\Omega),P)$ is our probability space for tossing coins, and it is isomorphic to the Lebesgue measure on $[0,1]$. 

8. Formalize $X\sim \!{Geom}(1/2)$ in this probability space.
    *Solution.*
    For any $\omega \in \Omega$, $X(\omega):=\min\set{i\in \^N | \omega_i=1}$.

[^algebra]: A set $\+F$ is an algebra if for every $A,B\in\+F$, it holds $A^c\in \+F$ and $A\cup B\in\+F$.





## Conditional Expectation

1. Let $X$ be a random variable and $f:\^R\to\^R$ be a Borel function. We usually use $f(X)$ to denote the random variable: $\omega\in\Omega \mapsto f(X(\omega))\in\^R$. Prove that $f(X)$ is $\sigma(X)$-measurable.
    *Proof.*
    For any Borel set $B \subseteq \^R$, $(f\circ X)^{-1}(B)=X^{-1}(f^{-1}(B)) \in \sigma(X)$.
    
2. Let $Y,Y'$ be two random variables such that $\sigma(Y)=\sigma(Y')$. Prove that $\E{X\mid Y}=\E{X\mid Y'}$.
    *Proof.* 
    It suffices to show that $Y^{-1}(Y(\omega))=Y'^{-1}(Y'(\omega))$. Since  $\sigma(Y)=\sigma(Y')$, if there exists $\omega\in \Omega$ such that $Y^{-1}(Y(\omega))\neq Y'^{-1}(Y'(\omega))$, $Y^{-1}(Y(\omega))\cap Y'^{-1}(Y'(\omega))\subseteq \sigma(Y)$, contradicting to the definition of $Y^{-1}(Y(\omega))$ and $Y'^{-1}(Y'(\omega))$. Therefore, $\E{X|Y^{-1}(Y(\omega))}=\E{X|Y'^{-1}(Y'(\omega))}$
    
    
3. The fact you just proved should convince you that the conditional expectation $\E{X\mid Y}$ only depends on the $\sigma$-algebra $\sigma(Y)$ (but not the value of $Y$). Let $\Omega$ be the set of outcomes and $X:\Omega\to\^R$ be a random variable. Let $\+F$ be a $\sigma$-algebra on $\Omega$. Can you define the notation $\E{X\mid \+F}$?
    *Solution.*
    Let $Y=\E{X\mid\+F}$ such that $\int_{A}YdP=\int_{A}XdP$ for any $A\in \+F$ and $Y$ is $\+F$-measurable. 
    If $\Omega$ is a countable set, we can explicitly give a definition of $Y$. First we need to prove the following lemma.
    
    :::info
    **Lemma:** any $\sigma$-algebra on a     countable set has a unique partition.
    :::
    * (Existence). For any $A\in \mathcal{F}$, if there exist a subset $A'\subset A$ and $A'\in \mathcal{F}$, we split $A$ into $A\cap A'$ and $A\setminus A'$. Moerover, we repeat this procedure for $A\cap A'$ and $A\setminus A'$ respectively; otherwise $A$ is a partition itself. Note that $\Omega$ is countable, therefore, the first step will proceed for at most countable times. According to the defintion of $\sigma$-algebra, we know the intersection of the set chain lies in $\mathcal{F}$ which claims the existence of the partition.
    * (Uniqueness). There can only be one partition. Suppose there are two partition $M_i$ and $M'_i$, then there exists $M\in M_i$ and $M'\in  M'_i$ such that $M\cap M\neq \emptyset$. It means that neither $M_i$ nor $M'_i$ is a partition.
    
    Armed with above lemma, assume that the partition of $\+F$ is formed by $\{M_i\}_{i>0}$. For any $\omega\in M_i$, $Y(\omega)=\E{X|\+F}(\omega)=\E{X|M_i}=\frac{\sum_{a\in Ran(X)}a\cdot P(X^{-1}(a)\cap M_i)}{P(M_i)}$.

<!--    The main idea is to prove that the smallest sets of $\+F$ containing a specific element in $\Omega$ are equal or disjoint. 
    For any $x,y$ in $\Omega$, if there exists an set $A\in\+F$ containing $x$ but not $y$, let $S_{x,y}=A$, otherwise $S_{x,y}=\Omega$. The countable intersetion $S_x=\cap_{y\in \Omega}S_{x,y}$ is a set in $\+F$. For any $z\in S_x$, we have $S_{x,z}=\Omega$, which implies all the sets containing $x$ in $\+F$ also contains $z$. Thus $S_x$ is a subset of  all the sets containing $x$ (maybe uncountable) in $\+F$. In a nutshell, $S_x\subseteq \cap_{B\in\+F,x\in B}B$ and $S_x\in\+F$. Therefore, $S_x$ is the smallest set in $\+F$ which contains $x$ and also the intersection over all elements in $\+F$ containing $x$.
    Now for any $\alpha,\beta\in \Omega$, if there exists an $A\in \+F$ such that $\alpha\in A$ but $\beta\notin A$, let $S_{\alpha,\beta}=A$ and $S_{\beta,\alpha}=\bar{A}$ (note that $\bar{A}\in \+F$). Then $S_\alpha\cap S_\beta=\emptyset$. If there is no such $A$ in $\+F$, all the sets in $\+F$ containing $\beta$ must contain $\alpha$. Thus $\alpha\in S_\beta$. $S_\alpha$, however, is the smallest $\sigma$-algebra in $\+F$ containing $\alpha$. So $S_\alpha\subseteq S_\beta$. Similarly we have $S_\beta\subseteq S_\alpha$. Then $S_\alpha=S_\beta$. According to the proof above, we know $S_\alpha$ is unique and therefore the partition is unique.
-->
  
    
    
4. (The coarser always wins) Let $\+F_1,\+F_2$ be two $\sigma$-algebra such that $\+F_1\subseteq\+F_2$ and $X:\Omega\to\^R$ be a random variable. Prove that $\E{\E{X\mid \+F_1}\mid \+F_2} = \E{\E{X\mid \+F_2}\mid\+F_1}=\E{X\mid\+F_1}$.
    *Proof.*
    For $A\in \+F_1 \subset \+F_2$,
    $$\int_{A}\E{X|\+F_1}dP=\int_{A}XdP=\int_{A}\E{X|\+F_2}dP.$$
    According to the definition of conditional expectation, we know if $X$ is $\+F$-measurable, then $\E{X|\+F}=X$.
    
    Therefore, $\E{\E{X\mid\+F_2}\mid\+F_1}=\E{\E{X\mid\+F_1}\mid \+F_1}=\E{X\mid \+F_1}$.
    $\E{X\mid\+F_1}$ is $\+F_1$-measurable, therefore $\+F_2$-measurble, so $\E{\E{X\mid \+F_1}\mid \+F_2}=\E{X\mid \+F_1}$.
    
